import{u as m,j as e,r as d,c as P,a as R,m as h,L as I,C as b,b as L}from"./index-h_Cm8zyL.js";import{P as C}from"./wrapper_home-WldBO3yS.js";import{N as T,H as E}from"./h1-DgSDIaRN.js";import{P as v,R as O}from"./PasswordInput-CZpLUbNY.js";const A=i=>/^[a-zA-Z0-9]{4,15}$/.test(i),F=({password:i})=>{const{t:c}=m(),t=(s=>{let a=0;return s?(s.length>5&&(a+=1),s.length>7&&/\d/.test(s)&&(a+=1),s.length>9&&/[!@#$%^&*(),.?":{}|<>]/.test(s)&&(a+=1),s.length>11&&(a+=1),a):0})(i),g=()=>t===0?"bg-gray-200 dark:bg-slate-700":t<=1?"bg-red-500":t===2?"bg-yellow-500":t===3?"bg-blue-500":"bg-green-500",f=["","Weak","Fair","Good","Strong"];return e.jsx("div",{className:"w-full max-w-5xl px-1 md:w-[55vw] lg:w-[70vw]",children:e.jsxs("div",{className:"flex h-1.5 w-full overflow-hidden rounded-full bg-gray-200 dark:bg-slate-700",children:[e.jsx("div",{className:`h-full transition-all duration-300 ${g()}`,style:{width:`${t/4*100}%`}}),t>0&&e.jsx("span",{className:"sr-only",children:f[t]})]})})};function U(){const i="/user/registr",[c,x]=d.useState(""),[t,g]=d.useState(""),[f,s]=d.useState(""),[a,N]=d.useState(!1),n=d.useRef(),w=d.useRef(),y=P(),{setAuth:j}=R(),{t:r}=m();d.useEffect(()=>{w.current.focus()},[]);const k=async l=>{l.preventDefault();try{if(!A(c)){n.current?.addNotification(r("registration.invalidLogin"),3e3);return}if(t!==f){n.current?.addNotification(r("registration.pwddif"),3e3);return}const o=JSON.parse(localStorage.getItem("anonymousLinks")||"[]"),u=await L.post(i,JSON.stringify({user:c,pwd:t,anonymousCodes:o}),{headers:{"Content-Type":"application/json"},withCredentials:!0}),S=u?.data?.accessToken,p=u?.data?.userId;console.log(p),j({user:c,pwd:t,accessToken:S,userId:p}),x(""),g(""),s(""),localStorage.removeItem("anonymousLinks"),y(b.PROFILE)}catch(o){if(!o?.response)n.current?.addNotification(r("message.servererror"),3e3);else if(o.response.status===429)n.current?.addNotification(o.response.data.error||r("message.ratelimit"),5e3);else if(o.response.data&&o.response.data.error){const u=o.response.data.error;u==="Username already exists"?n.current?.addNotification(r("registration.Usalreadyexists"),3e3):n.current?.addNotification(u,3e3)}else n.current?.addNotification(r("registration.registrationError"),3e3)}};return e.jsxs(e.Fragment,{children:[e.jsx(T,{ref:n}),e.jsxs(h.form,{onSubmit:k,className:"flex flex-col gap-5 rounded-2xl border border-gray-200 bg-white p-8 shadow-xl dark:border-slate-700 dark:bg-slate-800",transition:{duration:.2,ease:"easeOut"},children:[e.jsx(h.input,{className:"text-1xl h-16 w-3xs max-w-5xl rounded-lg border-2 border-sky-400 bg-white p-2 text-center text-gray-900 shadow-sm focus:ring-2 focus:ring-sky-500 focus:outline-none md:w-[55vw] md:text-2xl lg:h-20 lg:w-[70vw] lg:text-3xl dark:border-sky-500 dark:bg-slate-700 dark:text-gray-100",type:"text",placeholder:r("registration.loginPlaceholder"),value:c,ref:w,onChange:l=>{x(l.target.value)},whileFocus:{scale:1.02},transition:{duration:.2,ease:"easeOut"},required:!0}),e.jsxs("div",{className:"flex w-full flex-col items-center gap-2",children:[e.jsx(v,{className:"text-1xl h-16",placeholder:r("registration.passwordPlaceholder"),value:t,onChange:l=>g(l.target.value),required:!0,minLength:5,externalShowPassword:a,onToggle:N}),e.jsx(F,{password:t})]}),e.jsx(v,{className:"text-1xl h-16",placeholder:r("registration.passwordPlaceholderagain"),value:f,onChange:l=>s(l.target.value),required:!0,minLength:5,externalShowPassword:a,hideToggle:!0}),e.jsx(O,{children:r("registration.submit")}),e.jsx(h.div,{whileHover:{scale:1.05},transition:{duration:.2,ease:"easeOut"},children:e.jsx(I,{className:"text-lg text-sky-600 underline dark:text-sky-400",to:b.SIGNIN,children:r("registration.haveanacc")})})]})]})}function J(){const{t:i}=m();return e.jsxs(C,{children:[e.jsx(E,{children:i("registration.title")}),e.jsx(U,{})]})}export{J as default};
